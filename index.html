<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Land Cost Calculator</title>

  <!-- ‚úÖ jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    window.jsPDF = window.jspdf.jsPDF;
  </script>

  <style>
    * { box-sizing: border-box; font-family: Arial, sans-serif; }
    body { background: #f0f4f8; padding: 20px; color: #222; }
    .container { max-width: 900px; margin: auto; }
    .card {
      background: #fff; padding: 20px; border-radius: 10px;
      margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h2 { color: #1e3a8a; margin-bottom: 5px; }
    .row { display: flex; gap: 10px; flex-wrap: wrap; }
    .half { flex: 1 1 48%; }
    label { display: block; margin-top: 10px; font-weight: 600; }
    input, select {
      width: 100%; padding: 10px; margin-top: 5px;
      border-radius: 5px; border: 1px solid #ccc;
    }
    .result {
      padding: 10px; background: #eef2ff;
      border-radius: 8px; margin-top: 10px;
    }
    button {
      margin-top: 15px; padding: 12px; width: 100%;
      background: #1e3a8a; color: #fff; border: none;
      border-radius: 6px; font-size: 16px; cursor: pointer;
    }
    button:hover { background: #1e40af; }
    button:disabled { background: #94a3b8; cursor: not-allowed; }
    .note { font-size: 12px; color: #666; margin-top: 4px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h2>üè° Land Cost Calculator</h2>
      <p>Professional real estate investment calculator</p>

      <!-- Area Input Toggle -->
      <label for="areaMode">üìê How do you want to enter area?</label>
      <select id="areaMode" onchange="toggleAreaMode()">
        <option value="dimensions">Length √ó Breadth (sq. ft.)</option>
        <option value="direct">Direct Area (sq. yards)</option>
      </select>

      <!-- Dimensions -->
      <div class="row" id="dimensionInputs">
        <div class="half">
          <label for="breadth">Breadth (sq. ft.) *</label>
          <input type="number" id="breadth" />
        </div>
        <div class="half">
          <label for="length">Length (sq. ft.) *</label>
          <input type="number" id="length" />
        </div>
      </div>

      <!-- Direct Area -->
      <div id="areaInput" style="display: none;">
        <label for="area">Area (sq. yards) *</label>
        <input type="number" id="area" />
      </div>

      <label for="cost">Cost per Sq. Yard (‚Çπ) *</label>
      <input type="number" id="cost" />

      <div class="row">
        <div class="half">
          <label for="state">State *</label>
          <select id="state">
            <option value="">Select State</option>
            <option value="punjab">Punjab</option>
            <option value="uttar_pradesh">Uttar Pradesh</option>
            <option value="himachal_pradesh">Himachal Pradesh</option>
            <!-- Add other states here -->
          </select>
        </div>
        <div class="half">
          <label for="applicant">Applicant Category *</label>
          <select id="applicant">
            <option value="">Select</option>
            <option value="M">Male</option>
            <option value="W">Female</option>
          </select>
        </div>
      </div>

      <label for="wm">Registered Sale Value (‚Çπ) *</label>
      <input type="number" id="wm" />

      <label for="otherCharges">Other Charges (Writer + Mutation + Court, etc.)</label>
      <input type="number" id="otherCharges" placeholder="Leave empty for auto estimate" />
      <div class="note">‚ÑπÔ∏è Stamp duty & registration are auto-calculated based on state and gender. Do not include them here.</div>

      <button onclick="calculate()">Calculate Investment</button>
      <button id="exportBtn" onclick="exportPDF()" disabled>üìÑ Export as PDF</button>
    </div>

    <div class="card" id="resultsCard" style="display: none;">
      <h2>üìä Calculation Results</h2>
      <div class="result" id="areaResult"></div>
      <div class="result" id="landCost"></div>
      <div class="result" id="stampDuty"></div>
      <div class="result" id="otherChargesResult"></div>
      <div class="result" id="total" style="background: #d1fae5; font-weight: bold;"></div>
    </div>
  </div>
<script>
  // Toggle area input mode
  function toggleAreaMode() {
    const mode = document.getElementById("areaMode").value;
    document.getElementById("dimensionInputs").style.display = mode === "dimensions" ? "flex" : "none";
    document.getElementById("areaInput").style.display = mode === "direct" ? "block" : "none";
  }

  // Stamp duty logic
  function getDutyRate(state, gender, wm) {
    if (state === "himachal_pradesh") {
      return gender === "M" ? (wm <= 5000000 ? 6 : 8) : (wm <= 8000000 ? 4 : 8);
    }
    if (state === "uttarakhand") return gender === "M" ? 7 : 5.75;
    if (state === "karnataka") return wm <= 2000000 ? 2 : wm <= 4500000 ? 3 : 5;

    const rates = {
      punjab: { M: 8, W: 6 },
      uttar_pradesh: { M: 8, W: 7 },
    };
    return rates[state]?.[gender] || 7;
  }

  function getOtherCharges(area, state) {
    if (state === 'punjab') {
      if (area <= 30) return 10000;
      if (area <= 60) return 12000;
      if (area <= 100) return 14000;
      return 16000;
    }
    return area <= 100 ? 14000 : area <= 200 ? 16000 : 20000;
  }

  function formatCurrency(amount) {
    return new Intl.NumberFormat('en-IN', {
      style: 'currency',
      currency: 'INR',
      minimumFractionDigits: 0
    }).format(amount);
  }

  function calculate() {
    const mode = document.getElementById("areaMode").value;
    const b = parseFloat(document.getElementById("breadth").value);
    const l = parseFloat(document.getElementById("length").value);
    const areaInput = parseFloat(document.getElementById("area").value);
    const rate = parseFloat(document.getElementById("cost").value);
    const wm = parseFloat(document.getElementById("wm").value);
    const state = document.getElementById("state").value;
    const applicant = document.getElementById("applicant").value;
    const customOther = parseFloat(document.getElementById("otherCharges").value);

    let area = 0;
    if (mode === "dimensions") {
      if (isNaN(b) || isNaN(l)) return alert("Enter length and breadth");
      area = (b * l) / 9;
    } else {
      if (isNaN(areaInput)) return alert("Enter area");
      area = areaInput;
    }

    if (!state || !applicant || isNaN(rate) || isNaN(wm)) {
      alert("Please fill all required fields");
      return;
    }

    const landCost = area * rate;
    const duty = getDutyRate(state, applicant, wm);
    const stampDuty = wm * (duty / 100);
    const otherCharges = !isNaN(customOther) && customOther > 0 ? customOther : getOtherCharges(area, state);
    const total = landCost + stampDuty + otherCharges;

    document.getElementById("areaResult").innerHTML = `<strong>Area:</strong> ${area.toFixed(2)} sq. yards`;
    document.getElementById("landCost").innerHTML = `<strong>Land Cost:</strong> ${formatCurrency(landCost)}`;
    document.getElementById("stampDuty").innerHTML = `<strong>Stamp Duty + Registration:</strong> ${formatCurrency(stampDuty)}`;
    document.getElementById("otherChargesResult").innerHTML = `<strong>Other Charges:</strong> ${formatCurrency(otherCharges)}`;
    document.getElementById("total").innerHTML = `<strong>Total Investment:</strong> ${formatCurrency(total)}`;
    document.getElementById("resultsCard").style.display = "block";
    document.getElementById("exportBtn").disabled = false;
  }

  function exportPDF() {
    const doc = new jsPDF();

    const logo = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAoCAYAAACMs+nrAAABhUlEQVR4nO3XQQrCQBBF0evpP//u7koZkEohA28z0hpt74BS7LwovfsIkqRERERERERERERERERERERER8T9GvCH7kx4TTIXOHNNMhd4c009YcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMdYcEVaYfMfW3YT7ef8Cm0cZ3ltXakMAAAAASUVORK5CYII=";

    doc.addImage(logo, 'PNG', 70, 10, 70, 20);

    let y = 35;
    doc.setFontSize(16);
    doc.text("Land Cost Calculator Report", 20, y);
    y += 10;
    doc.setFontSize(11);
    doc.text(`Date: ${new Date().toLocaleDateString()}`, 20, y);

    const mode = document.getElementById("areaMode").value;
    const state = document.getElementById("state").value;
    const applicant = document.getElementById("applicant").value;
    const rate = parseFloat(document.getElementById("cost").value);
    const wm = parseFloat(document.getElementById("wm").value);
    const customOther = parseFloat(document.getElementById("otherCharges").value);
    const b = parseFloat(document.getElementById("breadth").value);
    const l = parseFloat(document.getElementById("length").value);
    const areaInput = parseFloat(document.getElementById("area").value);

    let area = mode === "dimensions" ? (b * l) / 9 : areaInput;

    const landCost = area * rate;
    const duty = getDutyRate(state, applicant, wm);
    const stampDuty = wm * (duty / 100);
    const otherCharges = !isNaN(customOther) && customOther > 0 ? customOther : getOtherCharges(area, state);
    const total = landCost + stampDuty + otherCharges;

    y += 15;
    doc.setFontSize(13);
    doc.text("Property Details", 20, y); y += 8;
    doc.setFontSize(11);
    doc.text(`State: ${state.replace(/_/g, ' ')}`, 20, y); y += 8;
    doc.text(`Applicant: ${applicant === 'M' ? 'Male' : 'Female'}`, 20, y); y += 8;
    doc.text(`Area: ${area.toFixed(2)} sq. yards`, 20, y); y += 8;
    doc.text(`Rate: ‚Çπ${rate.toLocaleString()}/sq. yard`, 20, y); y += 8;
    doc.text(`Sale Value: ‚Çπ${wm.toLocaleString()}`, 20, y);

    y += 12;
    doc.setFontSize(13);
    doc.text("Cost Breakdown", 20, y); y += 8;
    doc.setFontSize(11);
    doc.text(`Land Cost: ‚Çπ${landCost.toLocaleString()}`, 20, y); y += 8;
    doc.text(`Stamp Duty + Reg.: ‚Çπ${stampDuty.toLocaleString()}`, 20, y); y += 8;
    doc.text(`Other Charges: ‚Çπ${otherCharges.toLocaleString()}`, 20, y); y += 10;

    doc.setFontSize(13);
    doc.setTextColor(0, 128, 0);
    doc.text(`Total Investment: ‚Çπ${total.toLocaleString()}`, 20, y);

    doc.save("Land_Cost_Report.pdf");
  }
</script>
</body>
</html>

